# eBay Sold Price Lookup for Craigslist

A Chrome extension that shows eBay sold-price statistics and recent comparable sales directly on Craigslist listing pages. Make informed buying and selling decisions with real market data.

## Overview

This extension automatically analyzes Craigslist listings and shows you what similar items actually sold for on eBay. It uses AI-powered vision to identify products from photos and text, then queries eBay's completed listings to give you:

- **Price statistics**: Average, median, min, and max sold prices
- **Recent sales**: 5-10 comparable items with prices and dates
- **Smart matching**: OpenAI vision analyzes listing photos to identify brands, models, and specs

### Use Cases

- **Buyers**: Know if you're getting a fair deal before making an offer
- **Sellers**: Price your items competitively based on real market data
- **Negotiators**: Back up your offers with actual sold prices
- **Researchers**: Quickly understand market value for any item type

## Prerequisites

Before installing, you'll need:

1. **Google Chrome** browser
2. **RapidAPI Key** - Free tier includes 50 requests/month
   - Sign up at [RapidAPI](https://rapidapi.com/)
   - Subscribe to [eBay Average Selling Price API](https://rapidapi.com/letscrape-6bRBa3QguO5/api/ebay-average-selling-price)
3. **OpenAI API Key** - Pay-as-you-go pricing (~$0.01-0.05 per lookup)
   - Get your key at [OpenAI Platform](https://platform.openai.com/api-keys)

## Installation

### Step 1: Download the Extension

Clone or download this repository:

```bash
git clone https://github.com/yourusername/EbayLookupChromePlugin.git
```

Or download as ZIP and extract it.

### Step 2: Load into Chrome

1. Open Chrome and navigate to `chrome://extensions/`
2. Enable **Developer mode** (toggle in top-right corner)
3. Click **Load unpacked**
4. Select the `EbayLookupChromePlugin` folder

The extension should now appear in your extensions list.

### Step 3: Configure API Keys

1. Right-click the extension icon in your toolbar
2. Select **Options** (or go to `chrome://extensions` → Details → Extension options)
3. Enter your **RapidAPI Key**
4. Enter your **OpenAI API Key**
5. Click **Save**

You should see a "Saved successfully!" confirmation.

## Usage

### Basic Workflow

1. Browse Craigslist and open any listing detail page
   - Example: `https://sfbay.craigslist.org/.../d/...`
2. The extension automatically activates and shows a panel at the bottom of the page
3. Wait a few seconds while it analyzes the listing (with photos if available)
4. View the results:
   - **Price Statistics**: Avg/Median/Min/Max from actual eBay sales
   - **Recent Comps**: List of similar items that sold recently
   - **Status**: Shows if data is cached or freshly fetched

### Panel Features

- **Refresh Button**: Bypass cache and fetch fresh data from eBay
- **Show Debug Button**: View detailed information about the query:
  - OpenAI status and response
  - Confidence score
  - Images analyzed
  - Final query sent to eBay

### Understanding the Results

- **Cached results**: Data from previous lookup (up to 14 days old) - instant
- **Fresh results**: New query to OpenAI + eBay - takes 3-5 seconds
- **No results**: Query might be too specific, or item is rare on eBay

### Debug Panel

Click "Show Debug" to see:
- **OpenAI Status**: Success/Error with details
- **Model**: Which AI model was used (gpt-4o-mini with vision)
- **Confidence**: How confident the AI is about the product identification
- **Images Analyzed**: Number of photos processed
- **OpenAI Response**: The search parameters generated by AI
- **Final Query**: The actual request sent to eBay

This is helpful for troubleshooting why results might not match expectations.

## Features

### Vision-Powered Product Identification
- Analyzes up to 3 listing photos
- Identifies brand names, model numbers, and specs from images
- Reads labels, logos, and product stickers
- Works for electronics, bicycles, appliances, and more

### Smart Query Generation
- OpenAI generates optimal search keywords
- Removes fluff text ("obo", "must sell", "READ THE AD")
- Adds relevant filters (category, brand, model)
- Balances precision vs. recall for best matches

### Local Caching
- Results cached for 14 days
- Saves API quota and provides instant results
- Cache stored locally in Chrome (no external server)
- Clear cache with Refresh button

### Privacy-Focused
- No backend server
- All processing happens locally in your browser
- API calls go directly to OpenAI and RapidAPI
- No data collected or stored externally

## Troubleshooting

### "API keys not configured" Error

**Solution**: Go to extension options and enter both API keys.

1. Right-click extension icon → Options
2. Enter both RapidAPI and OpenAI keys
3. Click Save

### OpenAI Error in Debug Panel

**Check the error message**:
- `HTTP 401`: Invalid OpenAI API key
- `HTTP 429`: Rate limit exceeded (slow down)
- `Invalid schema`: Report as bug (shouldn't happen)

**Solution**:
- Verify your OpenAI key is valid
- Check your OpenAI account has credits
- Wait a few minutes if rate limited

### No Results Found

**Possible causes**:
1. Item is too rare or specific for eBay
2. Brand/model couldn't be identified from listing
3. OpenAI query was too restrictive

**Solutions**:
- Click "Show Debug" to see the query used
- Try refreshing to regenerate the query
- Check if the listing has clear photos and descriptions

### Extension Not Loading on Page

**Verify**:
1. You're on a Craigslist listing detail page (not search results)
2. URL matches pattern: `*://*.craigslist.org/*/d/*`
3. Extension is enabled in `chrome://extensions`

**Solution**: Reload the page, or try a different listing.

### RapidAPI Quota Exceeded

Free tier: 50 requests/month

**Solution**:
- Upgrade your RapidAPI subscription
- Use the cache (don't refresh unnecessarily)
- Wait until next month for quota reset

## How It Works

1. **Extraction**: Reads title, price, description, category, and images from Craigslist
2. **Vision Analysis**: Sends listing data + photos to OpenAI (gpt-4o-mini)
3. **Query Generation**: AI creates optimal eBay search parameters
4. **eBay Search**: Queries RapidAPI for sold items matching the parameters
5. **Display**: Shows statistics and comparable sales in the bottom panel
6. **Caching**: Stores results locally for 14 days

### Technical Stack
- Pure JavaScript (no frameworks or build tools)
- Chrome Manifest V3
- OpenAI API (vision-capable model)
- RapidAPI eBay Average Selling Price API

## Limitations

- **Personal use only** - Not intended for Chrome Web Store publishing
- **API costs** - Pay-per-use for OpenAI (~$0.01-0.05/lookup), RapidAPI free tier = 50/month
- **Craigslist only** - Only works on Craigslist listing detail pages
- **US-focused** - eBay data is primarily from ebay.com (US)
- **Accuracy** - Depends on AI's ability to identify products from photos/text
- **No guarantees** - Sold prices are historical data, not current market value

## Development

### File Structure

```
/
├── manifest.json          # Extension configuration
├── content.js             # Main logic (all modules in one file)
├── panel.css              # Panel styling
├── options.html           # Options page UI
└── options.js             # Options page logic
```

### Making Changes

1. Edit files directly (no build process needed)
2. Go to `chrome://extensions`
3. Click the reload icon on the extension card
4. Refresh the Craigslist page you're testing on

### Module Organization (in content.js)

- **CONFIG**: Constants and configuration
- **Cache**: Local storage management
- **Extractor**: Craigslist data extraction
- **OpenAI**: AI-powered query generation
- **Sanitizer**: Request validation and sanitization
- **RapidAPI**: eBay data fetching
- **Panel**: UI rendering and interaction
- **App**: Main orchestrator

## Credits

- [OpenAI API](https://openai.com/) - GPT-4o-mini for vision-based product identification
- [RapidAPI](https://rapidapi.com/) - eBay Average Selling Price API
- Craigslist (data extraction only, no affiliation)

## License

Personal use only. Not licensed for redistribution or commercial use.

---

**Note**: This extension is for personal use to help make informed buying/selling decisions. It does not scrape, store, or redistribute Craigslist or eBay data. All API calls are made directly from your browser to the respective services.
